---
title: "CVE-2022-23221"
category: security-announcements
date: October 14 2024
---

# CVE-2022-23221

<p class="doc-info">WSO2 Products impacted: no</p>
<p class="doc-info">Customers actions required: no</p>
---

### REPORTED VULNERABILITY

H2 Console before 2.1.210 allows remote attackers to execute arbitrary code via a jdbc:h2:mem JDBC URL containing the IGNORE_UNKNOWN_SETTINGS=TRUE;FORBID_CREATION=FALSE;INIT=RUNSCRIPT substring [^1].

### REPORTED PRODUCTS

- WSO2 API Manager : 3.2.0
- Any other WSO2 products containing the H2 Database Engine before 2.1.210

### WSO2 JUSTIFICATION

This vulnerability in the H2 Console that could allow arbitrary code execution in versions prior to 2.1.210, potentially exposing systems to remote attacks via a JDBC URL.

However, it's important to note that the default configuration of the H2 Console significantly mitigates this risk by restricting access to the console, making it inaccessible from external sources. As a result, this vulnerability does not impact WSO2 products.

Furthermore, the H2 web based console is disabled by default, and newer WSO2 product versions including APIM 4.2.0 onwards even removes `deployment.toml` configuration option to enable/disable the H2 web console.
While it was previously possible to enable the console, it was only accessible via localhost, meaning that an attacker would have needed to gain access to the server or container to exploit any vulnerabilities.

### CONCLUSION

Due to following key points,

- The H2 Console is not enabled or exposed externally in WSO2 products by default.
- Access to the console, even when enabled, was restricted to localhost, requiring attackers to have server-level access.
- Upgrading to a H2 version that is not flagged for this vulnerability requires backward incompatible changes to the product. This requires users of WSO2 products to perform a data migration, when the vulnerability itself can never affect security of WSO2 products.

Therefore, WSO2 concludes that **this is not an exploitable vulnerability in WSO2 products**, and **an H2 update will not be performed due to CVE-2022-23221**[^1].

### REFERENCES
[^1]: [https://nvd.nist.gov/vuln/detail/CVE-2022-23221](https://nvd.nist.gov/vuln/detail/CVE-2022-23221)
